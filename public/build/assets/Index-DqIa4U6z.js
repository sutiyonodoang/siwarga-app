import{r as d,j as e}from"./utils-BSArQRAP.js";import{H as _,r as p}from"./app-gPlSlMMq.js";import{C as j}from"./card-CxStm2Cj.js";import{B as m}from"./badge-Dd1uZi1Y.js";import{B as g}from"./createLucideIcon-ZlkySu63.js";import{T as A,a as $,b as f,c as v}from"./tabs-Dsu7IKkd.js";import{T as k,a as B,b as N,c as t,d as E,e as l}from"./table-CnF3Sme4.js";import{S as L,a as P,b as H,c as V,d as I}from"./select-2V-9gRbf.js";import{A as z}from"./app-layout-D272FG62.js";import{P as D}from"./protected-page-DDXWLHu3.js";import{S as y,a as K,U as n}from"./small-mode-toggle-Cq2mG1yl.js";import"./vendor-CjZsb-BP.js";/* empty css            */import"./index-DaO20brY.js";import"./index-PXYs5pws.js";import"./check-DPxztf0j.js";import"./chevron-up-DxbvufES.js";import"./app-logo-icon-DvYaJ0Ys.js";function de({roles:b}){const[c,w]=d.useState([]),[R,M]=d.useState(b),[h,x]=d.useState(!1),[o,S]=d.useState({}),i=async()=>{x(!0);try{const a=await(await fetch("/api/users-with-roles")).json();w(a.users)}catch(s){console.error("Error loading users:",s)}finally{x(!1)}},T=async(s,a)=>{try{await p.post("/roles/assign-to-user",{user_id:s,role_id:a}),i()}catch(r){console.error("Error assigning role:",r)}},C=async(s,a)=>{try{await p.post("/roles/remove-from-user",{user_id:s,role_id:a}),i()}catch(r){console.error("Error removing role:",r)}},u=s=>{switch(s){case"admin":return"bg-red-100 text-red-800 hover:bg-red-200";case"operator":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"viewer":return"bg-green-100 text-green-800 hover:bg-green-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}},U=s=>{s==="user-roles"&&c.length===0&&i()};return e.jsx(D,{permission:"user_edit",children:e.jsxs(z,{breadcrumbs:[{title:"Dashboard",href:"/dashboard"},{title:"Kelola Role",href:"/roles"}],children:[e.jsx(_,{title:"Role Management"}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:e.jsx(y,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Role Management"}),e.jsx("p",{className:"text-gray-600",children:"Kelola role dan permission user"})]})]}),e.jsxs(A,{defaultValue:"roles",onValueChange:U,className:"w-full",children:[e.jsxs($,{className:"grid w-full grid-cols-2 bg-white/70 backdrop-blur-sm border border-white/20 shadow-lg",children:[e.jsxs(f,{value:"roles",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-purple-500 data-[state=active]:text-white",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Roles & Permissions"]}),e.jsxs(f,{value:"user-roles",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-purple-500 data-[state=active]:text-white",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"User Role Assignment"]})]}),e.jsx(v,{value:"roles",className:"space-y-6 mt-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:b.map((s,a)=>e.jsxs(j,{className:`p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 ${a===0?"ring-2 ring-red-200 bg-gradient-to-br from-red-50 to-pink-50":a===1?"ring-2 ring-blue-200 bg-gradient-to-br from-blue-50 to-cyan-50":"ring-2 ring-green-200 bg-gradient-to-br from-green-50 to-emerald-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(m,{className:`${u(s.name)} font-medium shadow-sm`,children:s.display_name}),e.jsx("div",{className:`p-2 rounded-full ${a===0?"bg-red-100":a===1?"bg-blue-100":"bg-green-100"}`,children:e.jsx(y,{className:`h-5 w-5 ${a===0?"text-red-500":a===1?"text-blue-500":"text-green-500"}`})})]}),e.jsx("h3",{className:"font-semibold text-lg mb-2 text-gray-800",children:s.display_name}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 leading-relaxed",children:s.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex justify-between text-sm p-2 rounded-lg ${a===0?"bg-red-50":a===1?"bg-blue-50":"bg-green-50"}`,children:[e.jsx("span",{className:"text-gray-600",children:"Permissions:"}),e.jsx("span",{className:`font-bold ${a===0?"text-red-600":a===1?"text-blue-600":"text-green-600"}`,children:s.permissions_count})]}),e.jsxs("div",{className:`flex justify-between text-sm p-2 rounded-lg ${a===0?"bg-red-50":a===1?"bg-blue-50":"bg-green-50"}`,children:[e.jsx("span",{className:"text-gray-600",children:"Users:"}),e.jsx("span",{className:`font-bold ${a===0?"text-red-600":a===1?"text-blue-600":"text-green-600"}`,children:s.users_count})]})]})]},s.id))})}),e.jsx(v,{value:"user-roles",className:"space-y-6 mt-6",children:e.jsxs(j,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg",children:e.jsx(n,{className:"h-5 w-5 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"User Role Assignment"})]}),h?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto"}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 opacity-20 animate-pulse"})]}),e.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Loading users..."})]}):e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:e.jsxs(k,{children:[e.jsx(B,{children:e.jsxs(N,{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:[e.jsx(t,{className:"font-semibold text-gray-700",children:"User"}),e.jsx(t,{className:"font-semibold text-gray-700",children:"Email"}),e.jsx(t,{className:"font-semibold text-gray-700",children:"Status"}),e.jsx(t,{className:"font-semibold text-gray-700",children:"Current Roles"}),e.jsx(t,{className:"font-semibold text-gray-700",children:"Assign Role"}),e.jsx(t,{className:"font-semibold text-gray-700",children:"Actions"})]})}),e.jsx(E,{children:c.map((s,a)=>e.jsxs(N,{className:`hover:bg-gradient-to-r ${a%2===0?"bg-white hover:from-blue-50 hover:to-purple-50":"bg-gray-50/50 hover:from-purple-50 hover:to-blue-50"} transition-all duration-200`,children:[e.jsx(l,{className:"font-medium text-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-400 to-purple-400 flex items-center justify-center text-white text-sm font-bold",children:s.name.charAt(0).toUpperCase()}),s.name]})}),e.jsx(l,{className:"text-gray-600",children:s.email}),e.jsx(l,{children:e.jsx(m,{variant:s.status==="enabled"?"default":"secondary",className:s.status==="enabled"?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200",children:s.status==="enabled"?"✓ Active":"✗ Disabled"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[s.roles.map(r=>e.jsx(m,{className:`${u(r.name)} shadow-sm`,children:r.display_name},r.id)),s.roles.length===0&&e.jsx("span",{className:"text-gray-400 text-sm italic bg-gray-100 px-2 py-1 rounded",children:"No roles assigned"})]})}),e.jsx(l,{children:e.jsxs(L,{value:o[s.id]||"",onValueChange:r=>{S({...o,[s.id]:r})},children:[e.jsx(P,{className:"w-40 bg-white border-gray-200 hover:border-blue-300 focus:border-blue-500 transition-colors",children:e.jsx(H,{placeholder:"Select role"})}),e.jsx(V,{className:"bg-white border-gray-200 shadow-lg",children:R.map(r=>e.jsx(I,{value:r.id.toString(),className:"hover:bg-blue-50 focus:bg-blue-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${r.name==="admin"?"bg-red-400":r.name==="operator"?"bg-blue-400":"bg-green-400"}`}),r.display_name]})},r.id))})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{size:"sm",onClick:()=>{const r=o[s.id];r&&T(s.id,r)},disabled:!o[s.id],className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"✓ Assign"}),s.roles.length>0&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{s.roles[0]&&C(s.id,s.roles[0].id)},className:"border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300 font-medium shadow-sm",children:"✗ Remove"})]})})]},s.id))})]})}),c.length===0&&!h&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(n,{className:"h-16 w-16 text-gray-300 mx-auto"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full opacity-30 blur-xl"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No users found"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by loading users to manage their roles"}),e.jsxs(g,{onClick:i,className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-medium shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),"Load Users"]})]})]})})]})]})]})})}export{de as default};
